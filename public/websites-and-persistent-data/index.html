<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.3/css/bootstrap.min.css">
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.3/css/bootstrap-theme.min.css">
</head>
<body>
	<div class="container">
		<div class="page-header">
			<h1>Websites and Persistent Data</h1>
			<p class="lead">This tutorial walks you through creating a website that utilizes persistent data. You will learn how to access an SQL database and manage data for your website.</p>
			<ul>Prequisites
				<li>HTML</li>
				<li>Basic Object Oriented Programming. PHP knowledge is helpful.</li>
				<li>Access to a MySQL Database</li>
			</ul>
			<p>* This tutorial intends to walk you through concepts and is designed to be langauge agnostic. Although this tutorial uses PHP as the server side programming language, the concepts can be coded in any language.</p>
		</div>
		<ul>
			<li>Design Specifications</li>
			<li>CGI responder</li>
			<li>SQL Tables</li>
			<li>SQL Queries</li>
			<li>SQL Injection prevention</li>
		</ul>
		<h3>Design Specifications</h3>

		<div class="panel-group" id="CGI_Responder_Section">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h4 class="panel-title">
						<a data-toggle="collapse" data-parent="#CGI_Responder_Section" href="#CGI_Responder">
							CGI responder
						</a>
					</h4>
				</div>
				<div id="CGI_Responder" class="panel-collapse collapse">
					<div class="panel-body">
						<p>Create a responder.<b>php</b> file on the website with the following code:</p>
		<pre>
&lt;?php
    print "Hello\n";
?>
</pre>

		<h4>Test the program</h4>
		<p>Test the program on the server</p>
		<pre>
php responder.php
</pre>
		<p>Remotely test program using cURL</p>
		<pre>
curl -k <b>"http://__URL__/response.php"</b>
</pre>
		<p>The server should respond to both with the following:</p>
		<pre>
Hello
</pre>
					</div>
				</div>
			</div>
		</div>


		<h3>SQL Tables</h3>
		<p>Creating a Database table.</p>

		<p>Create the following files:
			<ul>
				<li>Config.php</li>
				<li>Database.php</li>
				<li>Todo.php</li>
			</ul>
		</p>

		<p>Config.php
		<pre>
&lt;?php
namespace Websites_And_Persistent_Data;

class Config {
    const Hostname = 'localhost';
    const Username = 'training';
    const Password = 'training_password';
    const Database = 'training';
    const Table_Prefix = "EX_";
}
?>
</pre></p>

		<p>Database.php
		<pre>
&lt;?php
namespace Websites_And_Persistent_Data;

class Database {
    public static function initialize ($hostname, $username, $password, $database) {

        $dbh = new \mysqli($hostname, $username, $password, $database);

        if ($dbh->connect_error) {
            die("Connection failed: " . mysqli_connect_error() . "\n");
        }

        return $dbh;
    }
}
?>
</pre></p>

		<p>Todo.php
		<pre>
&lt;?php
namespace Websites_And_Persistent_Data;

class Todo {
    private static $table_name = 'todo';

    private $table_prefix;
    private $dbh;

    public function __construct ($prefix, $dbh) {
        $this->table_prefix = $prefix;
        $this->dbh = $dbh;
    }

    public function create () {
        $table = $this->table_prefix . self::$table_name;

        $sth = $this->dbh->prepare("
            CREATE TABLE IF NOT EXISTS $table (
                  todo_id INTEGER PRIMARY KEY AUTO_INCREMENT
                , task TEXT
                , completed INTEGER DEFAULT 0
            )");

        if (!$sth) {
            die("Error: " . $this->dbh->error . "\n");
        }

        $ok = $sth->execute();

        if (! $ok) {
            die("Error: " . $this->dbh->error . "\n");
        }
    }
}
?>
</pre></p>

		<p>responder.php
		<pre>
&lt;?php
namespace Websites_And_Persistent_Data;

include 'Config.php';
include 'Database.php';
include 'Todo.php';

$dbh = Database::initialize(
      Config::Hostname
    , Config::Username
    , Config::Password
    , Config::Database
    );

$todo = new Todo(
      Config::Table_Prefix
    , $dbh
    );

$todo->create();

?>
</pre>

		<h3>Conclusion</h3>


	</div>
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
</body>
</html>

